# Electron Image Scoring Gallery

## Project Overview

This is a high-performance image gallery application built with Electron, React, and Vite. It serves as a frontend for browsing and filtering images scored by the core Image Scoring engine.

## Core Technologies

- **Frontend**: React 19, TypeScript 5.9
- **Build Tool**: Vite 7
- **Electron**: 40.1.0
- **Database**: Firebird SQL (via `node-firebird`)
- **Styling**: Vanilla CSS (standard `App.css`, `index.css`)
- **State Management**: Zustand 5
- **UI Components**: Lucide React, React Virtuoso

## Key Entry Points

- `electron/main.ts` - Main process entry
- `src/main.tsx` - Renderer process entry
- `electron/db.ts` - Firebird database integration
- `run.bat` - Application launcher

## Directory Structure

```
electron-image-scoring/
├── electron/              # Electron main process source
│   ├── main.ts            # Entry point
│   ├── db.ts              # Database operations
│   ├── preload.ts         # Preload script
│   └── nefExtractor.ts    # RAW image extraction logic
├── src/                   # React renderer source
│   ├── components/        # UI components
│   ├── hooks/             # Custom React hooks
│   ├── services/          # API/DB service wrappers
│   ├── App.tsx            # Root component
│   └── main.tsx           # React entry point
├── public/                # Static assets
├── dist-electron/         # Compiled electron files
└── dist/                  # Compiled web files
```

## Database Integration (Firebird)

The app connects to a Firebird database (`SCORING_HISTORY.FDB`).
- **CRITICAL**: Use the shared database managed by the core Image Scoring project.
- **Port**: Default 3050.
- **Library**: `node-firebird`.
- All database logic should reside in `electron/db.ts` and be exposed via IPC to the renderer.

## IPC Pattern

1. Define handler in `electron/main.ts` using `ipcMain.handle`.
2. Expose function in `electron/preload.ts` via `contextBridge`.
3. Declare types in `src/electron.d.ts`.
4. Call from React components/hooks using `window.electronAPI`.

## Code Conventions

### React / TypeScript
- Use functional components and hooks.
- Prefer `interface` for defining object shapes.
- Leverage `zustand` for global state.
- Use `react-virtuoso` for large lists (gallery).

### Electron
- Keep main process slim; delegate heavy work to modules or separate processes if needed.
- Use `cross-env` for environment variable management.
- Ensure all file operations use absolute paths or are safely resolved.

### Styling
- Use CSS modules or standard CSS files.
- Maintain consistency with the existing simple, clean UI.

## Common Tasks

### Adding a new Database Query
1. Add function to `electron/db.ts`.
2. Update `ipcMain.handle` in `electron/main.ts`.
3. Add to `electron/preload.ts`.
4. Update `src/electron.d.ts`.

### Modifying the Gallery
- Main gallery logic is in `src/App.tsx` and `src/components/Gallery`.
- Filtering logic should be handled by the database (SQL queries) when possible.

## Key Dependencies

- `electron-is-dev`: Dev mode detection
- `exiftool-vendored`: EXIF metadata extraction
- `node-firebird`: Firebird DB client
- `zustand`: State management
- `lucide-react`: Icons
- `react-virtuoso`: Virtualized list for gallery performance
